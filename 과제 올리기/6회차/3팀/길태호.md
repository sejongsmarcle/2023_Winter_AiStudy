# 10,11장 실습문제 풀이
----
https://colab.research.google.com/drive/1BP0LTfTI0ELOSVQEHHOmwH5hIxbiEpqR#scrollTo=etbjicdyPPuc


# 13장: 과적합 피하기
-------
과적합이란 모델이 학습 데이터셋 안에서는 일정 수준 이상의 예측 정확도를 보이지만, 새로운 데이터에 적용하면 잘 맞지 않는 것을 말한다. 
![image](https://user-images.githubusercontent.com/94752167/218728759-a2d51abe-fb59-4360-9910-cdbbee5b2dea.png)    
위 그림에서 빨간 색은 주어진 샘플에만 정확히 맞고, 새로운 데이터에 적용하면 정확히 두 그룹으로 나누지 못한다.   
과적합은 층이 너무 많을 때도 발생하고, 테스트셋과 학습셋이 중복될 때 생기기도 한다.   
과적합을 피하기 위해서는 학습 데이터셋과 테스트 데이터셋을 구분하는 법이 있다.    
![image](https://user-images.githubusercontent.com/94752167/218729539-8049fac9-6210-4cb7-ada0-9f4ec1a05370.png)    
위 그림처럼 학습 데이터로 학습하여 모델을 생성하고, 이후 테스트 데이터로 모델의 성능을 평가한다.    
학습 데이터로 평가를 하게 되면, 실행 횟수가 늘을수록 정확도가 개선되지만, 과적합이 일어날 수도 있다.   
![image](https://user-images.githubusercontent.com/94752167/218730043-70d5413c-1469-43d0-8665-aff62cafdccf.png)    
위 그래프와 같이 학습을 진행해도 테스트 결과가 더 이상 좋아지지 않는 지점에서 학습을 멈춰야 한다. 
사이킷런 라이브러리의 train_test_split()함수를 사용하여 정해진 비율로 학습 데이터셋과 테스트 데이터셋을 분리할 수 있다. (ex) train_test_split(x,y,test_size=0.3,random_state=seed)   

학습을 끝낸 수 테스트 결과가 좋으면 이 모델을 저장하여 새로운 데이터에 사용할 수 있다.   
![image](https://user-images.githubusercontent.com/94752167/218730930-366d2930-2d21-433f-859e-ebff3bedfe4f.png)    
이 모델을 다음과 같이 불러올 수 있다.    
![image](https://user-images.githubusercontent.com/94752167/218731035-fe3a0fce-b34e-4008-bc88-3085dcb1721f.png)     

- k겹 교차검증
학습 데이터셋과 테스트 데이터셋으로 나눌 경우 테스트할 데이터셋이 부족한 문제가 생긴다. 이 문제를 k겹 교차 검증으로 해결할 수 있다. k겹 교차검증은 쉽게 말해 팀을 나눠 어떨 때에는 학습에, 다를 때에는 테스트에 사용하는 것이다. 정확히 표현하면 데이터셋을 여러 개로 나누어 하나씩 테스트셋으로 사용하고 나머지는 모두 학습 데이터셋으로 사용하는 것이다. 이 방법으로 모든 데이터를 테스트셋으로 사용할 수 있다.   
![image](https://user-images.githubusercontent.com/94752167/218734933-25e52bfe-f8a8-498f-9eb0-7cc8470278ed.png)   

사이킷런에서 StratifiedKFold()함수를 사용하여 데이터를 원하는 숫자만큼 학습셋과 테스트셋으로 쪼개 사용할 수 있다.   
![image](https://user-images.githubusercontent.com/94752167/218735177-dc371143-1bed-4194-b108-4587c004c9b1.png)    
위 그림에서는 10개로 파일 쪼갠 10겹 교차검증을 실시했다.    
![image](https://user-images.githubusercontent.com/94752167/218735430-f34374ba-f2dc-446c-baff-e82080a02258.png)    
위 그림에서는 모델을 만들고 실행하는 부분을 for구분으로 묶어 n_fold만큼 반복되게 했다.    
train 데이터로 학습시킨 것을 볼 수 있다.    
![image](https://user-images.githubusercontent.com/94752167/218735935-339bc7dd-d6ec-4eb5-bda7-4d068dcb2b57.png)     
정확도를 test데이터로 평가하여 accuracy 배열로 나타낼 수 있다.    

# 14장: 베스트 모델 만들기
--------

























