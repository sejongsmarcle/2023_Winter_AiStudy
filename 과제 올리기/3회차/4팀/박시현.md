## ì‹¤ìŠµ ë¬¸ì œ

### ì½”ë“œ - ì§ì ‘ ìˆ˜ì‹

```python
import numpy as np
import matplotlib.pyplot as plt

data=[[3,6,70],[6,4,75],[9,5,80],[12,2,90]]

x1=[i[0] for i in data]
x2=[i[1] for i in data]
y=[i[2] for i in data]

import numpy as np
import matplotlib.pyplot as plt

data=[[3,6,70],[6,4,75],[9,5,80],[12,2,90]]

x1=[i[0] for i in data]
x2=[i[1] for i in data]
y=[i[2] for i in data]

#ê²½ì‚¬ í•˜ê°•ë²•

#ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì˜ ì´ˆê¸°ê°’ ì„¤ì •
a1=0
a2=0
b=0

#ê³„ì‚°í•˜ê¸° ìœ„í•´ ë°°ì—´ë¡œ ë°”ê¾¸ê¸°
x1_data=np.array(x1)
x2_data=np.array(x2)
y_data=np.array(y)

#í•™ìŠµë¥ ê³¼ ì—ì½”í”„ ì„¤ì •
lr=0.01
epochs=2000

#ê¸°ìš¸ê¸°ì™€ yì ˆí¸ ì°¾ê¸° ì‹œì‘
for i in range(epochs):
    y_pred=a1*x1_data+a2*x2_data+b
    error=y_pred-y_data
    
    #ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì˜ ê¸°ìš¸ê¸°
    a1_diff=(2/len(x1_data))*sum(x1_data*(error))
    a2_diff=(2/len(x1_data))*sum(x2_data*(error))
    b_diff=(2/len(x1_data))*sum(error)
    
    #ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì˜ ìˆ˜ì •ê³¼ì •
    a1=a1-lr*a1_diff
    a2=a2-lr*a2_diff
    b=b-lr*b_diff
    

result=a1*8+a2*4+b

print('8ì‹œê°„ì„ ê³µë¶€í•˜ê³  4ì‹œê°„ì˜ ê³¼ì™¸ë¥¼ ë°›ì„ ê²½ìš°, ì˜ˆìƒ ì ìˆ˜ëŠ” %.2fì ì…ë‹ˆë‹¤'%(result))

# 3D ê·¸ë˜í”„ ë§Œë“¤ê¸°
#ê·¸ë˜í”„ í™˜ê²½ ì„¤ì •
ax=plt.axes(projection='3d')
ax.set_xlabel('study_hours')
ax.set_ylabel('private_class')
ax.set_zlabel('score')
#yì¶•ê³¼ zì¶•ì˜ ê°„ê²© ì„¤ì •
ax.set_yticks(np.arange(2,6.5,step=0.5))
ax.set_zticks(np.arange(70,92.5,step=2.5))
#ë°ì´í„° ì‚°ì ë„ë¡œ í‘œí˜„í•˜ê¸°
ax.scatter(x1,x2,y)
#ê·¸ë˜í”„ ë³´ì—¬ì£¼ê¸°
plt.show()
```

<aside>
ğŸ’¡ ì²˜ìŒì— í•™ìŠµë¥ ì„ 0.02ë¡œ ì„¤ì •í•˜ì˜€ë”ë‹ˆ ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì´ nanìœ¼ë¡œ ì¶œë ¥ë˜ì—ˆë‹¤. ì´ëŠ” í•™ìŠµë¥ ì´ ë„ˆë¬´ í° ê²½ìš° ê¸°ìš¸ê¸°ê°€ ì ì°¨ ì»¤ì§€ë”ë‹ˆ ë¹„ì •ìƒì ìœ¼ë¡œ ì»¤ì ¸ ë°œì‚°í•˜ëŠ” ê¸°ìš¸ê¸° í­ì£¼ì˜ ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ë‹¤.

</aside>

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2cd838d8-ac61-49b8-9deb-aa5426a3be0a/Untitled.png)

[[ Deep Learning 02 ] ê²½ì‚¬í•˜ê°• í•™ìŠµë²• ( Gradient Descent ) , ì˜µí‹° ë§ˆì´ì € ( Optimizer )](https://hazel01.tistory.com/36)

### ì½”ë“œ- tensorflow ì´ìš©

```python
import numpy as np
import matplotlib.pyplot as plt

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

data=[[3,6,70],[6,4,75],[9,5,80],[12,2,90]]

x1=np.array([i[0] for i in data])
x2=np.array([i[1] for i in data])
x=np.array([[i[0],i[1]] for i in data])
y=np.array([i[2] for i in data])

model=Sequential()
model.add(Dense(1,input_dim=2,activation='linear'))
model.compile(optimizer='sgd',loss='mse')
model.fit(x,y,epochs=2000)

#ì„ì˜ì˜ ì‹œê°„ì„ ë„£ì–´ ì ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ í…ŒìŠ¤íŠ¸
hour= 8
private_class=4
prediction=model.predict([[hour,private_class]])
print('8ì‹œê°„ì„ ê³µë¶€í•˜ê³  4ì‹œê°„ì˜ ê³¼ì™¸ë¥¼ ë°›ì„ ê²½ìš°, ì˜ˆìƒ ì ìˆ˜ëŠ” %.2fì ì…ë‹ˆë‹¤'%(prediction))

# 3D ê·¸ë˜í”„ ë§Œë“¤ê¸°
#ê·¸ë˜í”„ í™˜ê²½ ì„¤ì •
ax=plt.axes(projection='3d')
ax.set_xlabel('study_hours')
ax.set_ylabel('private_class')
ax.set_zlabel('score')
#yì¶•ê³¼ zì¶•ì˜ ê°„ê²© ì„¤ì •
ax.set_yticks(np.arange(2,6.5,step=0.5))
ax.set_zticks(np.arange(70,92.5,step=2.5))
#ë°ì´í„° ì‚°ì ë„ë¡œ í‘œí˜„í•˜ê¸°
ax.scatter(x1,x2,y)
#ê·¸ë˜í”„ ë³´ì—¬ì£¼ê¸°
plt.show()
```
## ì°¸ ê±°ì§“ íŒë‹¨ ì¥ì¹˜: ë¡œì§€ìŠ¤í‹± íšŒê·€

<aside>
ğŸ’¡ ë”¥ëŸ¬ë‹ì˜ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ë‘ ê°€ì§€ ê³„ì‚° ì›ë¦¬ì¸ **ì„ í˜• íšŒê·€**ì™€ **ë¡œì§€ìŠ¤í‹± íšŒê·€**
ê·¸ ì¤‘ ë¡œì§€ìŠ¤í‹± íšŒê·€ì— ëŒ€í•œ ë‹¨ì›ì´ë‹¤. 

âœ… **ë¡œì§€ìŠ¤í‹± íšŒê·€**
ì°¸ê³¼ ê±°ì§“ì„ íŒë‹¨í•˜ëŠ” ê³¼ì •

âœ… **ë”¥ëŸ¬ë‹ì˜ ì‘ë™ ì›ë¦¬**
**ë”¥ëŸ¬ë‹**ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì€ ì „ë‹¬ë°›ì€ ì •ë³´ë¥¼ ë†“ê³  **ì°¸ê³¼ ê±°ì§“ì„ íŒë‹¨**í•˜ì—¬ ë³µì¡í•œ ì—°ì‚°ì„ í•œ ëì— ìµœì ì˜ ì˜ˆì¸¡ ê°’ì„ ë‚´ë†“ëŠ” ì‘ì—…ì´ë‹¤.  ì¦‰, **ë¡œì§€ìŠ¤í‹± íšŒê·€**ë¥¼ ì´ìš©í•˜ì—¬ T/F íŒë‹¨ ì¥ì¹˜ë¥¼ ë§Œë“¤ì–´ **ì…ë ¥ê°’ì˜ íŠ¹ì§•ì„ ì¶”ì¶œ**í•˜ê³  ëª¨ë¸ì— ì €ì¥í•˜ì—¬ ë¹„ìŠ·í•œ ì§ˆë¬¸ì´ ë‚˜ì™”ì„ ë•Œ **ì €ì¥í•´ë†¨ë˜ ëª¨ë¸**ì„ êº¼ë‚´ ë‹µí•˜ëŠ” ì›ë¦¬ì´ë‹¤.

</aside>

## ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ ì •ì˜

<aside>
ğŸ’¡ ì…ë ¥ê°’ê³¼ ì¶œë ¥ê°’ì˜ ê´€ê³„ê°€ ì§ì„ ì˜ í˜•íƒœë¡œ í•´ê²°ë˜ëŠ” ì„ í˜• íšŒê·€ì™€ëŠ” ë‹¬ë¦¬ **ì§ì„ ìœ¼ë¡œ í‘œí˜„ë˜ì§€ ì•ŠëŠ” ê´€ê³„ë„ ì¡´ì¬.** ì˜ˆë¥¼ ë“¤ì–´, ****ì¶œë ¥ê°’ì´ True(1), False(0)ë¡œ êµ¬ë¶„ë˜ëŠ” ê²½ìš° ì ë“¤ì˜ íŠ¹ì„±ì„ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ **Sì í˜•íƒœ**ë¡œ ê·¸ë˜í”„ë¥¼ ë‚˜íƒ€ë‚´ì•¼ í•¨.

</aside>

### ê¸°ë³¸ ê°œë…-ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜

<aside>
ğŸ’¡ **ë°‘ì˜ ê°’ì´ ìì—° ìƒìˆ˜ e**ì¸ í•¨ìˆ˜ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŒ

$f(x)={1 \over 1+e^-x}$ 

xê°€ **ì»¤ì§ˆìˆ˜ë¡ 1ì—** ê°€ê¹Œì›Œì§€ê³  **ì‘ì•„ì§ˆìˆ˜ë¡ 0**ì— ê°€ê¹Œì›Œì§. **ë‘ ê°œì˜ ê°’** ì¤‘ í•˜ë‚˜ë¥¼ ê³ ë¥¼ ë•Œ ìœ ìš©í•˜ê²Œ ì“°ì´ëŠ” í•¨ìˆ˜ì´ë‹¤.

</aside>

<aside>
ğŸ’¡ **ì‹œê·¸ëª¨ì´ë“œ** í•¨ìˆ˜â†’ **ë¡œì§€ìŠ¤í‹± íšŒê·€** 

$y={1 \over 1+e^-(ax+b)}$ 

**ê²½ì‚¬ë„ a**
aê°€ ì»¤ì§€ë©´ ê²½ì‚¬ê°€ ì»¤ì§€ê³ , aê°€ ì‘ì•„ì§€ë©´ ê²½ì‚¬ê°€ ì‘ì•„ì§„ë‹¤

**ê·¸ë˜í”„ì˜ ì¢Œìš° ì´ë™ b**
bê°€ í¬ê³  ì‘ì•„ì§ì— ë”°ë¼ ê·¸ë˜í”„ê°€ ì´ë™í•¨

</aside>

<aside>
ğŸ’¡ **ê²½ì‚¬ë„ a**

aê°€ **ì»¤ì§ˆ** ë•Œ ê²½ì‚¬ê°€ **ì»¤ì§€ê³ ** aê°€ ì‘ì•„ì§€ë©´ ê²½ì‚¬ê°€ ì‘ì•„ì§„ë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5afa364a-e8a1-4cf3-a171-868f6821f071/Untitled.png)   
  
a ê°’ì´ ì‘ì„ ë•Œ ì˜¤ì°¨ê°€ ë¬´í•œëŒ€ë¡œ ì»¤ì§€ë©°, a ê°’ì´ ì»¤ì§„ë‹¤ê³  í•´ì„œ ì˜¤ì°¨ê°€ ì ì  ì‘ì•„ì§„ë‹¤. ì´ë ‡ê²Œ aì— ë”°ë¼ **ì˜¤ì°¨ ê·¸ë˜í”„**ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.  

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/975eacef-4f65-4241-99df-d48619b6c162/Untitled.png)

</aside>

<aside>
ğŸ’¡ **ê·¸ë˜í”„ì˜ ì¢Œìš° ì´ë™ b**

bì˜ í¬ê¸°ì— ë”°ë¼ ê·¸ë˜í”„ê°€ ë‹¤ìŒê³¼ ê°™ì´ ì´ë™í•œë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3fd0cbcb-0219-4f23-8fef-562d40ce3541/Untitled.png)

bê°€ ë„ˆë¬´ í¬ê±°ë‚˜ ì‘ì„ ê²½ìš°ì— ì˜¤ì°¨ ê·¸ë˜í”„ëŠ” ì´ì°¨ í•¨ìˆ˜ ê·¸ë˜í”„ì™€ ìœ ì‚¬í•œ í˜•íƒœë¡œ ë‚˜íƒ€ë‚œë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7f230e0-f3dc-41b4-a749-422aac05f8b8/Untitled.png)

</aside>

## ì˜¤ì°¨ ê³µì‹ - ë¡œê·¸ í•¨ìˆ˜

<aside>
ğŸ’¡ ê²°êµ­ ì¤‘ìš”í•œ ê²ƒì€ aì™€ bì˜ ê°’ì„ êµ¬í•˜ëŠ” ê²ƒì´ë„¤ìš” ! ê²½ì‚¬ í•˜ê°•ë²•ì„ ì´ìš©í•˜ì—¬ ì˜¤ì°¨ë¥¼ êµ¬í•œ ë’¤ ì‘ì€ ìª½ìœ¼ë¡œ ì´ë™ì‹œì¼œ ë´…ì‹œë‹¤ ! í•˜ì§€ë§Œ ìš”ê±´ ì§ì„  ê·¸ë˜í”„ê°€ ì•„ë‹Œ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ê·¸ë˜í”„ì£ ? ì´ ê·¸ë˜í”„ì˜ íŠ¹ì§•ì„ ì´ìš©í•˜ì—¬ ì˜¤ì°¨ ê³µì‹ì„ ë„ì¶œí•´ ë´…ì‹œë‹¤ğŸ˜Š 

ì‹¤ì œê°’ì´ 0ì¼ ë•Œ 1ê³¼ ê°€ê¹Œì›Œì§€ë©´ ì˜¤ì°¨ê°€ ì»¤ì§€ê³  ì‹¤ì œê°’ì´ 1ì¼ ë•Œ 0ê³¼ ê°€ê¹Œì›Œì§€ë©´ ì˜¤ì°¨ê°€ ì»¤ì§€ë¯€ë¡œ ì´ëŠ” **ë¡œê·¸ í•¨ìˆ˜**ì™€ ì—°ê²°ì§€ì„ ìˆ˜ ìˆì–´ìš”!

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5c183f18-174c-4f71-ae63-13032538ccdd/Untitled.png)

$-(y_data*logh+(1-y_data)*log(1-h))$

**ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜** **ì˜¤ì°¨ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜**

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0bf6bb9a-2d22-47b8-ab9b-351558e417cd/Untitled.png)

</aside>

## ë¡œì§€ìŠ¤í‹± íšŒê·€ ì½”ë”©í•˜ê¸°

### ì½”ë“œ

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

#ê³µë¶€ ì‹œê°„ xì™€ í•©ê²© ì—¬ë¶€ yì˜ ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°
data=[[2,0],[4,0],[6,0],[8,1],[10,1],[12,1],[14,1]]

x_data=[i[0] for i in data]
y_data=[i[1] for i in data]

#ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ê¸°
plt.scatter(x_data,y_data)
plt.xlim(0,15)
plt.ylim(-.1,1.1)

#ê¸°ìš¸ê¸°ì™€ yì ˆí¸ ê°’ ì´ˆê¸°í™”
a=0
b=0

#í•™ìŠµë¥ 
lr=0.05

#ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ì •ì˜
def sigmoid(x):
    return 1/(1+np.e**(-x))

#í˜„ì¬ì˜ a ê°’ê³¼ b ê°’ ì¶œë ¥
for i in range(2001):
    for x_data,y_data in data:
        a_diff=x_data*(sigmoid(a*x_data+b)-y_data) **#í¸ë¯¸ë¶„ ê³¼ì •ì€ ìƒëµí•œë‹¤.**
        b_diff=sigmoid(a*x_data+b)-y_data
        a=a-lr*a_diff
        b=b-lr*b_diff
        
        if i%1000==0:
            print("epoch=%.f, ê¸°ìš¸ê¸°=%0.4f, ì ˆí¸=%0.4f"%(i,a,b))

#ì•ì„œ êµ¬í•œ ê¸°ìš¸ê¸°ì™€ ì ˆí¸ìœ¼ë¡œ ì‹œê·¸ëª¨ì´ë“œ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
plt.scatter(x_data,y_data)
plt.xlim(0,15)
plt.ylim(-.1,1.1)
x_range=(np.arange(0,15,0.1))
plt.plot(x_range,np.array([sigmoid(a*x+b) for x in x_range]))
plt.show()
```

<aside>
ğŸ’¡ **ì…ë ¥ ê°’ì´ ì„¸ ê°œ** ì´ìƒì˜ ì…ë ¥ ê°’ì„ ë‹¤ë£¬ë‹¤ë©´ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ê°€ ì•„ë‹Œ **ì†Œí”„íŠ¸ë§¥ìŠ¤**ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì¨ì•¼ í•œë‹¤!

</aside>

## ë¡œì§€ìŠ¤í‹± to í¼ì…‰íŠ¸ë¡ 

<aside>
ğŸ’¡ $y=a_1x_1+a_2x_2+b$

ì´ëŠ” x1,x2ì˜ ì…ë ¥ ê°’ì´ **ê°€ì¤‘ì¹˜** a1,a2ì™€ ë§Œë‚˜ê³  **bias** bë¥¼ ë”í•´ **ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜**ë¥¼ ê±°ì³ 1 ë˜ëŠ” 0ì˜ ì¶œë ¥ ê°’ì„ ì¶œë ¥í•œë‹¤. ì´ëŸ¬í•œ **í¼ì…‰íŠ¸ë¡  ê°œë…**ì€ ì–´ë–»ê²Œ ë”¥ëŸ¬ë‹ì˜ ê³¨ê²©ì¸ ì‹ ê²½ë§ì„ êµ¬ì„±í• ê¹Œ? ë‹¤ìŒ ì°¨ì‹œ ã„±ã„±

</aside>

-----
-----

## ì‚¬ì§„ì´ ì•ˆ ë³´ì¸ë‹¤ë©´ ë…¸ì…˜ì„ í™•ì¸í•´ì£¼ì„¸ìš”!
[ë°•ì‹œí˜„ notion](https://spotless-fireman-cc9.notion.site/80766fd3d588459ebd0ef5759b7bb97d)
